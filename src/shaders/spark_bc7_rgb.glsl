uniform mediump sampler2D z;layout(location=0)out uvec4 u;void main(){ivec2 t=ivec2(uvec2(gl_FragCoord.xy)*uvec2(4u));int d=t.x,v=t.y;vec3 m=texelFetch(z,t,0).xyz,f=m;int x=d+1;vec3 y=texelFetch(z,ivec2(x,v),0).xyz,b=y;int a=d+2;vec3 i=texelFetch(z,ivec2(a,v),0).xyz;int g=d+3;vec3 c=texelFetch(z,ivec2(g,v),0).xyz;int l=v+1;vec3 n=texelFetch(z,ivec2(d,l),0).xyz,w=texelFetch(z,ivec2(x,l),0).xyz,B=texelFetch(z,ivec2(a,l),0).xyz,C=texelFetch(z,ivec2(g,l),0).xyz;l=v+2;vec3 s=texelFetch(z,ivec2(d,l),0).xyz,D=texelFetch(z,ivec2(x,l),0).xyz,F=texelFetch(z,ivec2(a,l),0).xyz,H=texelFetch(z,ivec2(g,l),0).xyz;l=v+3;vec3 G=texelFetch(z,ivec2(d,l),0).xyz,E=texelFetch(z,ivec2(x,l),0).xyz,A=texelFetch(z,ivec2(a,l),0).xyz,I=texelFetch(z,ivec2(g,l),0).xyz,J=f+b+i+c+n+w+B+C+s+D+F+H+G+E+A+I,K=min(min(min(min(min(min(min(min(min(min(min(min(min(min(min(f,b),i),c),n),w),B),C),s),D),F),H),G),E),A),I),e=max(max(max(max(max(max(max(max(max(max(max(max(max(max(max(f,b),i),c),n),w),B),C),s),D),F),H),G),E),A),I);f=f*16.-J;float L=f.x,M=f.y,N=f.z;b=b*16.-J;float O=b.x,P=b.y,Q=b.z;b=i*16.-J;float R=b.x,S=b.y,T=b.z;b=c*16.-J;float U=b.x,V=b.y,W=b.z;b=n*16.-J;float X=b.x,Y=b.y,Z=b.z;b=w*16.-J;float _=b.x,h=b.y,j=b.z;b=B*16.-J;float k=b.x,o=b.y,p=b.z;b=C*16.-J;float q=b.x,r=b.y,at=b.z;b=s*16.-J;float am=b.x,ax=b.y,ab=b.z;b=D*16.-J;float ay=b.x,ah=b.y,aj=b.z;b=F*16.-J;float ak=b.x,ao=b.y,ap=b.z;b=H*16.-J;float aq=b.x,ar=b.y,aL=b.z;b=G*16.-J;float aM=b.x,aN=b.y,aO=b.z;b=E*16.-J;float az=b.x,aP=b.y,aQ=b.z;b=A*16.-J;float au=b.x,aJ=b.y,aR=b.z;b=I*16.-J;float aI=b.x,ag=L*L+O*O+R*R+U*U+X*X+_*_+k*k+q*q+am*am+ay*ay+ak*ak+aq*aq+aM*aM+az*az+au*au+aI*aI,al=b.y,ai=b.z,an=M*M+P*P+S*S+V*V+Y*Y+h*h+o*o+r*r+ax*ax+ah*ah+ao*ao+ar*ar+aN*aN+aP*aP+aJ*aJ+al*al,aw=N*N+Q*Q+T*T+W*W+Z*Z+j*j+p*p+at*at+ab*ab+aj*aj+ap*ap+aL*aL+aO*aO+aQ*aQ+aR*aR+ai*ai,aA=max(max(ag,an),aw)>64.?.015625:1.,ad=ag*aA,aB=(L*M+O*P+R*S+U*V+X*Y+_*h+k*o+q*r+am*ax+ay*ah+ak*ao+aq*ar+aM*aN+az*aP+au*aJ+aI*al)*aA,aC=(L*N+O*Q+R*T+U*W+X*Z+_*j+k*p+q*at+am*ab+ay*aj+ak*ap+aq*aL+aM*aO+az*aQ+au*aR+aI*ai)*aA;az=an*aA;aJ=(M*N+P*Q+S*T+V*W+Y*Z+h*j+o*p+r*at+ax*ab+ah*aj+ao*ap+ar*aL+aN*aO+aP*aQ+aJ*aR+al*ai)*aA;au=aw*aA;vec3 bb=vec3(ad,az,au)+vec3(.0001220703125),af=bb*(1./max(max(bb.x,bb.y),bb.z));float bd=uintBitsToFloat(floatBitsToUint(af.x)^floatBitsToUint(aB)&2147483648u),aU=uintBitsToFloat(floatBitsToUint(af.z)^floatBitsToUint(aJ)&2147483648u),aX=af.y,aD=bd*ad+aX*aB+aU*aC,aE=bd*aB+aX*az+aU*aJ,av=bd*aC+aX*aJ+aU*au,aF=max(max(abs(aD),abs(aE)),abs(av));vec3 bf=vec3(aD,aE,av)*(1./(aF==0.?1.:aF));float bo=bf.x,a_=bf.y,aS=bf.z,aG=bo*ad+a_*aB+aS*aC,aH=bo*aB+a_*az+aS*aJ,ac=bo*aC+a_*aJ+aS*au,bu=max(max(abs(aG),abs(aH)),abs(ac));bool as=bu==0.;vec3 aa=vec3(aG,aH,ac)*(1./(as?1.:bu));float aV=aa.x,aY=aa.y,aK=aa.z,aT=dot(aa,aa),ae=ad+az+au;bvec3 aW=bvec3(as);float bz=abs((aJ+(aJ<0.?-1.:1.)*.0078125)*inversesqrt(az*au+6103515625e-14)),aZ=abs((aC+(aC<0.?-1.:1.)*.0078125)*inversesqrt(ad*au+6103515625e-14)),bx=abs((aB+(aB<0.?-1.:1.)*.0078125)*inversesqrt(ad*az+6103515625e-14)),bs=abs(dot(vec3(aV*ad+aY*aB+aK*aC,aV*aB+aY*az+aK*aJ,aV*aC+aY*aJ+aK*au),aa)*(1./(aT==0.?1.:aT)));vec3 bl=(e-K)*vec3(.897000014781952,1.55400002002716,.549000024795532);float bv=bl.x,by=bl.y,bJ=bv+by,bF=bl.z;int bc=bz>max(bx,aZ)?1:aZ>bx?2:3;bool bi=bc==1,bn=bc==2,bw=bc==3;vec3 bA=vec3(float(bi),float(bn),float(bw)),bB=vec3(1)-bA;float bk=dot(bA,bl);vec3 ba=bl*bB;float bL=ba.x+ba.y+ba.z,bC=bL+bk*.5,bD=bL*.5+bk;int bE=int(bD<bC),bG=(bJ+bF)*.0625+.01171875+(bJ*(1.-bx)+(bv+bF)*(1.-aZ)+(by+bF)*(1.-bz))<min(bC,bD)*.25+.03125?6:bs/ae>.975000023841858?6:ae-bs<aA*.5?6:4;bool bH=bG==4;bvec3 bW=bvec3(bH);vec3 bI=vec3(bW.x?bA.x:vec3(0).x,bW.y?bA.y:vec3(0).y,bW.z?bA.z:vec3(0).z),bm=vec3(1)-bI,bg=J*.0625*bm,bQ=K*bI,be=e*bI;float bU=bm.x,bX=bm.y,cb=bU*bX*aB,ch=bm.z,cd=bU*ch*aC,cg=bX*ch*aJ;vec3 bt=vec3(aW.x?vec3(1).x:aa.x,aW.y?vec3(1).y:aa.y,aW.z?vec3(1).z:aa.z)*bm;float bh=bt.x,cl=bt.y,b_=bt.z,bT=ad*bU*bh+cl*cb+b_*cd,bZ=bh*cb+az*bX*cl+b_*cg,bK=bh*cd+cl*cg+au*ch*b_,bM=max(max(abs(bT),abs(bZ)),abs(bK));bool bN=bM==0.;vec3 bO=vec3(bT,bZ,bK)*(1./(bN?1.:bM));bvec3 bP=bvec3(bN);vec3 bq=vec3(bP.x?bm.x:bO.x,bP.y?bm.y:bO.y,bP.z?bm.z:bO.z),bS=bq*vec3(.897000014781952,1.55400002002716,.549000024795532);float co=1./dot(bS,bS);vec3 bR=bS*co*vec3(.897000014781952,1.55400002002716,.549000024795532);float cz=dot(m,bR),bV=dot(y,bR);bool bY=bV<cz;uint bj=bY?0u:1u;float bp=bY?bV:cz;bool br=bV>cz;uint cu=br?0u:1u;float cx=br?bV:cz,cy=dot(i,bR);bool cH=cy<bp;uint cJ=cH?0u:bV==bp?bj+1u:bj;float cA=cH?cy:bp;bool cE=cy>cx;uint cB=cE?0u:bV==cx?cu+1u:cu;float cC=cE?cy:cx,cc=dot(c,bR);bool cn=cc<cA;uint cj=cn?0u:cy==cA?cJ+1u:cJ;float cp=cn?cc:cA;bool cw=cc>cC;uint cQ=cw?0u:cy==cC?cB+1u:cB;float cI=cw?cc:cC,cV=dot(n,bR);bool cG=cV<cp;uint cL=cG?0u:cc==cp?cj+1u:cj;float cY=cG?cV:cp;bool ci=cV>cI;uint cN=ci?0u:cc==cI?cQ+1u:cQ;float ca=ci?cV:cI,cD=dot(w,bR);bool cr=cD<cY;uint cv=cr?0u:cV==cY?cL+1u:cL;float cm=cr?cD:cY;bool cF=cD>ca;uint cM=cF?0u:cV==ca?cN+1u:cN;float cs=cF?cD:ca,cT=dot(B,bR);bool cf=cT<cm;uint cO=cf?0u:cD==cm?cv+1u:cv;float ck=cf?cT:cm;bool cK=cT>cs;uint cP=cK?0u:cD==cs?cM+1u:cM;float cS=cK?cT:cs,cZ=dot(C,bR);bool cR=cZ<ck;uint cW=cR?0u:cT==ck?cO+1u:cO;float cU=cR?cZ:ck;bool cX=cZ>cS;uint ct=cX?0u:cT==cS?cP+1u:cP;float c_=cX?cZ:cS,ce=dot(s,bR);bool cq=ce<cU;uint dz=cq?0u:cZ==cU?cW+1u:cW;float du=cq?ce:cU;bool db=ce>c_;uint dB=db?0u:cZ==c_?ct+1u:ct;float dx=db?ce:c_,dy=dot(D,bR);bool dE=dy<du;uint dj=dE?0u:ce==du?dz+1u:dz;float dA=dE?dy:du;bool dH=dy>dx;uint dJ=dH?0u:ce==dx?dB+1u:dB;float dC=dH?dy:dx,dc=dot(F,bR);bool di=dc<dA;uint dp=di?0u:dy==dA?dj+1u:dj;float dm=di?dc:dA;bool dn=dc>dC;uint dQ=dn?0u:dy==dC?dJ+1u:dJ;float dI=dn?dc:dC,dD=dot(H,bR);bool dw=dD<dm;uint dd=dw?0u:dc==dm?dp+1u:dp;float dG=dw?dD:dm;bool dV=dD>dI;uint dL=dV?0u:dc==dI?dQ+1u:dQ;float dg=dV?dD:dI,dT=dot(G,bR);bool dr=dT<dG;uint dN=dr?0u:dD==dG?dd+1u:dd;float dY=dr?dT:dG;bool ec=dT>dg;uint dv=ec?0u:dD==dg?dL+1u:dL;float da=ec?dT:dg,dZ=dot(E,bR);bool dF=dZ<dY;uint dM=dF?0u:dT==dY?dN+1u:dN;float dk=dF?dZ:dY;bool df=dZ>da;uint dO=df?0u:dT==da?dv+1u:dv;float ds=df?dZ:da,de=dot(A,bR);bool dK=de<dk;uint dP=dK?0u:dZ==dk?dM+1u:dM;float dU=dK?de:dk;bool dR=de>ds;uint dW=dR?0u:dZ==ds?dO+1u:dO;float dS=dR?de:ds,dl=dot(I,bR);bool dX=dl<dU;uint dh=dX?0u:de==dU?dP+1u:dP;float dq=dX?dl:dU;bool d_=dl>dS;uint dt=d_?0u:de==dS?dW+1u:dW;float ex=d_?dl:dS,ey=dot(bg,bR),el=dq-ey,et=ex-ey,ez=1.-clamp(float((dl==dq?dh+1u:dh)+(dl==ex?dt+1u:dt)-2u)*.0714285746216774,0.,1.),eb=(et-el)*(bH?bE!=0?.03125:.0625:.015625)*ez,eu=el+eb,eB=et-eb,ee=bH?.03125:.0078125,eD=max(0.,(.635999977588654*ee*co+.363999992609024*ee-eB+eu)*.5);vec3 eC=bI*(dot(be-bQ,bI)*((bE!=0?.0625:.03125)*ez)),ef=clamp(bq*(eu-eD)+bg,vec3(0),vec3(1))+bQ+eC,ea=clamp(bq*(eB+eD)+bg,vec3(0),vec3(1))+be-eC,eI,eJ;if(bH){float a=bi?63.:31.,b=bi?4.0625:8.25,u=trunc(ef.x*a)*b,d=trunc(u),c=trunc(u+b),f=bn?63.:31.,z=bn?4.0625:8.25,y=trunc(ef.y*f)*z,x=trunc(y),e=trunc(y+z),l=bw?63.:31.,i=bw?4.0625:8.25,v=trunc(ef.z*l)*i,m=trunc(v),R=trunc(v+i),B=trunc(ea.x*a)*b,C=trunc(B);B=trunc(B+b);v=trunc(ea.y*f)*z;y=trunc(v);f=trunc(v+z);u=trunc(ea.z*l)*i;b=trunc(u);a=trunc(u+i);eJ=vec3(255.*ea.x>.5*(C+B)?B:C,255.*ea.y>.5*(y+f)?f:y,255.*ea.z>.5*(b+a)?a:b);eI=vec3(255.*ef.x>.5*(d+c)?c:d,255.*ef.y>.5*(x+e)?e:x,255.*ef.z>.5*(m+R)?R:m);}else eJ=vec3(2.*trunc(ea.x*127.5)+1.,2.*trunc(ea.y*127.5)+1.,2.*trunc(ea.z*127.5)+1.),eI=vec3(2.*trunc(ef.x*127.5)+1.,2.*trunc(ef.y*127.5)+1.,2.*trunc(ef.z*127.5)+1.);vec3 ed=eJ-eI,ei=ed*bm*vec3(.0035176472738385,.0060941181145608,.002152941422537),eR=ei*(1./dot(ei,ei))*vec3(.897000014781952,1.55400002002716,.549000024795532);float eA=dot(eI,eR)*.0039215688593686;uint eT;vec3 ev;float eg;if(bH){vec3 b=bI*dot(ed,bI)*.0039215688593686;b*=1./dot(b,b);float d=dot(eI,b)*.0039215688593686;bool a=bE==1;float x=a?d:eA;bvec3 e=bvec3(a);vec3 l=vec3(e.x?b.x:eR.x,e.y?b.y:eR.y,e.z?b.z:eR.z);eg=a?eA:d;ev=vec3(e.x?eR.x:b.x,e.y?eR.y:b.y,e.z?eR.z:b.z);eT=uint(3.*clamp(dot(m,l)-x,0.,1.)+.5)|uint(3.*clamp(dot(y,l)-x,0.,1.)+.5)<<uint(2)|uint(3.*clamp(dot(i,l)-x,0.,1.)+.5)<<uint(4)|uint(3.*clamp(dot(c,l)-x,0.,1.)+.5)<<uint(6)|uint(3.*clamp(dot(n,l)-x,0.,1.)+.5)<<uint(8)|uint(3.*clamp(dot(w,l)-x,0.,1.)+.5)<<uint(10)|uint(3.*clamp(dot(B,l)-x,0.,1.)+.5)<<uint(12)|uint(3.*clamp(dot(C,l)-x,0.,1.)+.5)<<uint(14)|uint(3.*clamp(dot(s,l)-x,0.,1.)+.5)<<uint(16)|uint(3.*clamp(dot(D,l)-x,0.,1.)+.5)<<uint(18)|uint(3.*clamp(dot(F,l)-x,0.,1.)+.5)<<uint(20)|uint(3.*clamp(dot(H,l)-x,0.,1.)+.5)<<uint(22)|uint(3.*clamp(dot(G,l)-x,0.,1.)+.5)<<uint(24)|uint(3.*clamp(dot(E,l)-x,0.,1.)+.5)<<uint(26)|uint(3.*clamp(dot(A,l)-x,0.,1.)+.5)<<uint(28)|uint(3.*clamp(dot(I,l)-x,0.,1.)+.5)<<uint(30);}else eg=eA,ev=eR,eT=0u;float eU=bH?7.:15.;int eh=bH?3:4,eE=eh*2,eF=eh*3,eZ=eh*4,eG=eh*5,eH=eh*6,es=eh*7;uint em=uint(eU*clamp(dot(m,ev)-eg,0.,1.)+.5)|uint(eU*clamp(dot(y,ev)-eg,0.,1.)+.5)<<uint(eh)|uint(eU*clamp(dot(i,ev)-eg,0.,1.)+.5)<<uint(eE)|uint(eU*clamp(dot(c,ev)-eg,0.,1.)+.5)<<uint(eF)|uint(eU*clamp(dot(n,ev)-eg,0.,1.)+.5)<<uint(eZ)|uint(eU*clamp(dot(w,ev)-eg,0.,1.)+.5)<<uint(eG)|uint(eU*clamp(dot(B,ev)-eg,0.,1.)+.5)<<uint(eH)|uint(eU*clamp(dot(C,ev)-eg,0.,1.)+.5)<<uint(es),eV=uint(eU*clamp(dot(s,ev)-eg,0.,1.)+.5)|uint(eU*clamp(dot(D,ev)-eg,0.,1.)+.5)<<uint(eh)|uint(eU*clamp(dot(F,ev)-eg,0.,1.)+.5)<<uint(eE)|uint(eU*clamp(dot(H,ev)-eg,0.,1.)+.5)<<uint(eF)|uint(eU*clamp(dot(G,ev)-eg,0.,1.)+.5)<<uint(eZ)|uint(eU*clamp(dot(E,ev)-eg,0.,1.)+.5)<<uint(eG)|uint(eU*clamp(dot(A,ev)-eg,0.,1.)+.5)<<uint(eH)|uint(eU*clamp(dot(I,ev)-eg,0.,1.)+.5)<<uint(es),fb,ek;fb=bH?ek=eV>>uint(8),em|eV<<uint(24):(ek=eV,eV);uint eS=bH?eT:em;uvec3 eW=uvec3(eS,fb,ek);uint er=1u<<uint(bG);uvec4 fc;if(bG==6){bool b=(eS&8u)!=0u;uvec2 a=b?uvec2(~eS,~fb):eW.xy;bvec3 d=bvec3(b);vec3 c=vec3(d.x?eI.x:eJ.x,d.y?eI.y:eJ.y,d.z?eI.z:eJ.z),e=vec3(d.x?eJ.x:eI.x,d.y?eJ.y:eI.y,d.z?eJ.z:eI.z);uint x=(a.x&7u)<<uint(1)|a.x&4294967280u,u=uint(c.y)>>uint(1);uvec4 f=uvec4(er|uint(e.x)>>uint(1)<<7u|uint(c.x)>>uint(1)<<14u|uint(e.y)>>uint(1)<<21u|u<<28u,u>>4u|uint(e.z)>>uint(1)<<3u|uint(c.z)>>uint(1)<<10u|4294836224u,x,a.y);f.z=x|1u;fc=f;}else{vec3 b=bA*255.,a=eI*bB+b;b+=eJ*bB;uvec3 d;uint c,u,e,f;if((eS&2u)!=0u){bool b=bE==0;uvec3 a=eW;a.x=~eS;f=b?0u:5u;e=b?5u:0u;u=b?6u:0u;c=b?0u:6u;d=a;}else f=5u,e=0u,u=6u,c=0u,d=eW;uint z=(d.x&1u)+(d.x&4294967293u)>>uint(1);uvec3 v=d;v.x=z;uvec3 m;uint x,l,y,i;if((d.y&4u)!=0u){bool b=bE==1;i=b?0u:f;y=b?5u:e;l=b?u:0u;x=b?c:6u;m=uvec3(z,~d.y,d.z^65535u);}else i=f,y=e,l=u,x=c,m=v;z=(m.y&3u)+(m.y&4294967291u)>>uint(1)|m.z<<uint(31);y=(uint(a.x)>>uint(3)|(uint(a.y)&248u)<<uint(7)|(uint(a.z)&248u)<<uint(17))<<y|(uint(b.x)>>uint(3)|(uint(b.y)&248u)<<uint(7)|(uint(b.z)&248u)<<uint(17))<<i;i=z>>15u;uvec4 t=uvec4(er&4294967071u|uint(bc)<<5u|uint(bE)<<7u|y<<8u,y>>24u|(uint(dot(eI,bA))>>uint(2)<<x|uint(dot(eJ,bA))>>uint(2)<<l)<<6u|m.x<<18u,m.x>>14u|z<<17u,i);t.w=i|m.z>>uint(1)<<17u;fc=t;}u=fc;}
